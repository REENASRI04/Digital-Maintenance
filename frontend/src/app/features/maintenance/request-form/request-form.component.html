<div class="form-container fade-in">
    <mat-card class="glass-effect slide-up">
        <mat-card-header>
            <div class="header-icon">
                <mat-icon color="primary">add_task</mat-icon>
            </div>
            <mat-card-title>New Maintenance Request</mat-card-title>
            <mat-card-subtitle>Please provide details about the issue.</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
            <form [formGroup]="requestForm" (ngSubmit)="onSubmit()" class="modern-form">
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Category</mat-label>
                    <mat-select formControlName="category">
                        <mat-option *ngFor="let cat of categories" [value]="cat">
                            {{cat}}
                        </mat-option>
                    </mat-select>
                    <mat-icon matPrefix>category</mat-icon>
                    <mat-error *ngIf="requestForm.get('category')?.hasError('required')">Category is
                        required</mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Property Address</mat-label>
                    <textarea matInput formControlName="address" rows="2"></textarea>
                    <mat-icon matPrefix>location_on</mat-icon>
                    <mat-error *ngIf="requestForm.get('address')?.hasError('required')">Address is required</mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Issue Description</mat-label>
                    <textarea matInput formControlName="description" rows="4"></textarea>
                    <mat-icon matPrefix>description</mat-icon>
                    <mat-error *ngIf="requestForm.get('description')?.hasError('required')">Description is
                        required</mat-error>
                </mat-form-field>

                <div class="file-upload-section">
                    <label class="upload-label">
                        <mat-icon>cloud_upload</mat-icon>
                        <span>{{ fileName || 'Upload Photo/Video (Optional)' }}</span>
                        <input type="file" id="file" (change)="onFileSelected($event)" accept="image/*,video/*"
                            class="hidden-input">
                    </label>
                </div>

                <div class="error-message fade-in" *ngIf="error">
                    <mat-icon>report_gmailerrorred</mat-icon>
                    {{ error }}
                </div>

                <button mat-raised-button color="primary" type="submit" [disabled]="requestForm.invalid || loading"
                    class="submit-btn">
                    <span *ngIf="!loading">Submit Request</span>
                    <mat-spinner diameter="20" *ngIf="loading"></mat-spinner>
                </button>
            </form>
        </mat-card-content>
    </mat-card>
</div>